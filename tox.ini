[tox]
envlist = py38,py39,py310,py311,py312
isolated_build = True
skip_missing_interpreters = True

[testenv]
description = Run unit tests and doctests
deps =
    google-api-python-client>=1.7.3
    google-auth>=1.5.0
    google-auth-oauthlib>=0.2.0
    python-dateutil>=2.7.3
passenv =
    SEARCHCONSOLE_CLIENT_CONFIG
    SEARCHCONSOLE_CREDENTIALS
    SEARCHCONSOLE_WEBPROPERTY_URI
    SEARCHCONSOLE_SERVICE_ACCOUNT
commands =
    python -m unittest tests

[testenv:lint]
description = Run code quality checks with ruff
skip_install = True
deps =
    ruff
commands =
    ruff check src/searchconsole tests.py
    ruff format --check src/searchconsole tests.py

[testenv:format]
description = Format code with ruff
skip_install = True
deps =
    ruff
commands =
    ruff format src/searchconsole tests.py
    ruff check --fix src/searchconsole tests.py

[testenv:coverage]
description = Run tests with coverage reporting
deps =
    {[testenv]deps}
    coverage
commands =
    coverage run -m unittest tests
    coverage report -m
    coverage html

[tool.ruff]
line-length = 100
exclude = [".tox", "*.egg", "build", "__pycache__"]

[tool.ruff.lint]
extend-ignore = ["E203", "W503"]
